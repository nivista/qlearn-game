(this["webpackJsonphello-world"]=this["webpackJsonphello-world"]||[]).push([[0],{139:function(e,t,a){e.exports=function(){return new Worker(a.p+"4b22d79751a1b66f2211.worker.js")}},172:function(e,t,a){e.exports=a(360)},177:function(e,t,a){},178:function(e,t,a){},179:function(e,t,a){},180:function(e,t,a){},358:function(e,t,a){},359:function(e,t,a){},360:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(45),l=a.n(s),i=(a(177),a(46)),o=a(47),c=a(51),d=a(48),u=a(52),f=Object.freeze({HUMAN_PLAY:"Human Play",BOT_PLAY:"Bot Play",BOT_TRAIN:"Bot Train"}),g=(a(178),a(179),a.p+"static/media/stickfigure.8aeec50f.png");var m=function(e){var t=e.col+1,a=e.row+1,n={gridColumnStart:t,gridColumnEnd:t+1,gridRowStart:a,gridRowEnd:a+1},s=e.data.agent?" agent":"",l=1===t&&1===a?" start":"";return console.log(),r.a.createElement("div",{onClick:e.switch,style:n,className:"gridSquare "+e.data.type+s+l},null,e.data.agent?r.a.createElement("img",{src:g}):null)},p=(a(180),a(141)),h=a(54);a(358);function v(e){var t=e.data,a=e.title,n=e.style;return r.a.createElement("div",{style:Object(p.a)({},n,{textAlign:"center"})},r.a.createElement("span",{class:"title"},a),r.a.createElement("button",{class:"reset",onClick:e.resetRewards},"Reset"),r.a.createElement(h.b,{width:400,height:200,data:t.map((function(e){return{data:e}})),title:"title"},r.a.createElement(h.a,{type:"monotone",dataKey:"data",stroke:"#8884d8"}),r.a.createElement(h.c,null)))}var w=function(e){var t=e.data.length,a=e.data[0].length,n={gridTemplateColumns:"60px ".repeat(a)+"auto",gridTemplateRows:"60px ".repeat(t)+"20px"},s=function(t,a){return function(){e.switchType(t,a)}},l=e.data.map((function(e,t){return e.map((function(e,a){return r.a.createElement(m,{switch:s(t,a),row:t,col:a,data:e,key:"".concat(t).concat(a)})})).flat()}));return r.a.createElement("div",{className:"grid",style:n,ref:e.aRef,onKeyDown:e.keyDownFunc,tabIndex:0},l,r.a.createElement(v,{style:{gridColumnStart:a+1,gridColumnEnd:a+2,gridRowStart:1,gridRowEnd:t+1},title:"Bot Rewards History",data:e.rewardsData,resetRewards:e.resetRewards}),r.a.createElement("p",{style:{gridColumnStart:1,gridColumnEnd:4,gridRowStart:t+1,gridRowEnd:t+2}},"Current Reward: ",Math.floor(10*e.currReward)/10),r.a.createElement("p",{style:{gridColumnStart:4,gridColumnEnd:7,gridRowStart:t+1,gridRowEnd:t+2}},"Last Reward: ",Math.floor(10*e.lastReward)/10||"_"))},R=(a(359),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).updateFailRate=function(e){a.setState({failRate:e.target.value}),a.props.updateFailRate(e)},a.updateCostOfLiving=function(e){a.setState({costOfLiving:e.target.value}),a.props.updateCostOfLiving(e)},a.props=e,a.state={costOfLiving:-.2,failRate:.1},a.colRef=r.a.createRef(),a.failRef=r.a.createRef(),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"controlPanel"},r.a.createElement("div",null,Object.values(f).map((function(t,a){return r.a.createElement("button",{onClick:function(){return e.props.setMode(t)},className:"mode".concat(t===e.props.mode?" selected":""),key:a},t)})),r.a.createElement("div",{style:{width:"10px",display:"inline-block"}}),r.a.createElement("button",{onClick:this.props.trainAsync,className:this.props.workingAsync?"training":""},"Train Asynchronously"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",null,"Cost of Living: ")),r.a.createElement("td",null,r.a.createElement("input",{value:this.state.costOfLiving,onChange:this.updateCostOfLiving,max:0,min:-10,step:.1,type:"number",ref:this.colRef,onClick:function(){return e.colRef.current.focus()}}))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",null,"Fail Rate: ")),r.a.createElement("td",null,r.a.createElement("input",{value:this.state.failRate,onChange:this.updateFailRate,min:0,max:1,type:"number",step:.1,ref:this.failRef,onClick:function(){return e.failRef.current.focus()}})))))),r.a.createElement("ol",null,r.a.createElement("li",null,"Use arrow keys to move the agent"),r.a.createElement("li",null,'The "Fail Rate" will determine the likelihood of the agent moving unexpectedly'),r.a.createElement("li",null,'Lose "Cost of Living" reward with every move'),r.a.createElement("li",null,"Left click to edit the board"),r.a.createElement("li",null,"You can't run into ",r.a.createElement("span",null,"black")," walls"),r.a.createElement("li",null,"Gain 10 reward for running into a"," ",r.a.createElement("span",{style:{color:"green"}},"green"),' "end state" and restart'),r.a.createElement("li",null,"Lose 10 reward for running into a"," ",r.a.createElement("span",{style:{color:"red"}},"red"),' "end state" and restart'),r.a.createElement("li",null,"See how the bot does, and",r.a.createElement("a",{href:"http://github.com/nivista/qlearn-game",target:"_blank"},"read more"),"!")))}}]),t}(r.a.Component)),y=a(139),b=a.n(y),E=a(140),k=a(55),O=function(e,t,a,n,r){var s=Math.random(),l=t;s<r/2?l++:s<r&&l--,l%=4;var i=a.slice();switch(l){case 0:i[1]--;break;case 1:i[0]--;break;case 2:i[1]++;break;case 3:i[0]++}(i[0]<0||i[0]>=e.length||i[1]<0||i[1]>=e[0].length)&&(i=a);var o,c=n,d=!1;switch(e[i[0]][i[1]].type){case"normal":o=Math.max.apply(Math,Object(k.a)(e[i[0]][i[1]].qVals));break;case"wall":i=a,o=Math.max.apply(Math,Object(k.a)(e[i[0]][i[1]].qVals));break;case"reward":c+=10,d=!0;break;case"cost":c+=-10,d=!0}return d&&(i=[0,0],o=0),{nextLoc:i,newQ:.9*e[a[0]][a[1]].qVals[t]+.1*(c+.99*o),changeInReward:c,gameover:d}};var C=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).focusDiv=function(){a.myRef.current.focus({preventScroll:!0})},a.switchType=function(e,t){var n=a.state.grid.slice();switch(n[e]=n[e].slice(),n[e][t].type){case"normal":n[e][t].type="wall";break;case"wall":n[e][t].type="reward";break;case"reward":n[e][t].type="cost";break;case"cost":n[e][t].type="normal"}a.setState({grid:n})},a.handleKeyDown=function(e){if(!(a.state.mode!==f.HUMAN_PLAY||e.keyCode<37||e.keyCode>40)){e.preventDefault();var t=e.keyCode-37,n=O(a.state.grid,t,a.state.agent,a.state.costOfLiving,a.state.failRate),r=n.nextLoc,s=n.newQ,l=n.changeInReward,i=n.gameover;a.updateState(t,r,s,l,i)}},a.setMode=function(e){if(a.state.mode!==e){clearInterval(a.state.botInterval);var t=null;e===f.BOT_TRAIN?t=setInterval(a.botMove,10):e===f.BOT_PLAY&&(t=setInterval(a.botMove,150)),a.setState({mode:e,botInterval:t})}},a.botMove=function(){var e=a.state.mode===f.BOT_TRAIN?.8:1,t=function(e,t,a){var n=e[t[0]][t[1]];if(Math.random()<a){var r=Math.max.apply(Math,Object(k.a)(n.qVals)),s=[];return n.qVals.forEach((function(e,t){e===r&&s.push(t)})),s[Math.floor(Math.random()*s.length)]}return[0,1,2,3].reduce((function(e,t){var a=Object(E.a)(e,2),r=a[0],s=a[1];return s<n.counts[t]?[r,s]:[t,n.counts[t]]}),[-1,Math.inf])[0]}(a.state.grid,a.state.agent,e),n=O(a.state.grid,t,a.state.agent,a.state.costOfLiving,a.state.failRate),r=n.nextLoc,s=n.newQ,l=n.changeInReward,i=n.gameover;a.updateState(t,r,s,l,i)},a.updateState=function(e,t,n,r,s){var l=a.state.grid.slice();l[a.state.agent[0]]=l[a.state.agent[0]].slice(),l[t[0]]=l[t[0]].slice();var i={};l[a.state.agent[0]][a.state.agent[1]]=Object.assign(i,l[a.state.agent[0]][a.state.agent[1]]),l[a.state.agent[0]][a.state.agent[1]]=i,i.qVals=i.qVals.slice(),i.qVals[e]=n,i.counts=i.counts.slice(),i.counts[e]++,i.agent=!1,l[t[0]][t[1]].agent=!0;var o=a.state.reward+r,c=a.state.lastReward;if(s&&a.state.mode!==f.HUMAN_PLAY){var d=a.state.botRewards.slice();d.push(o),a.setState({botRewards:d})}s&&(c=o,o=0),a.setState({reward:o,grid:l,lastReward:c,agent:t})},a.updateCostOfLiving=function(e){var t=parseFloat(e.target.value);!isNaN(t)&&t<=0&&t>=-10&&a.setState({costOfLiving:t})},a.updateFailRate=function(e){var t=parseFloat(e.target.value);!isNaN(t)&&t>=0&&t<=1&&a.setState({failRate:t})},a.trainAsync=function(){a.setState({workingAsync:!0}),a.worker.postMessage({grid:a.state.grid,agent:a.state.agent,costOfLiving:a.state.costOfLiving,failRate:a.state.failRate})};for(var n=[0,0],s=[],l=1;l<=5;l++){var o=[];s.push(o);for(var u=1;u<=10;u++)o.push({type:"normal",agent:!1,qVals:[0,0,0,0],counts:[0,0,0,0]})}return s[n[0]][n[1]].agent=!0,a.state={grid:s,mode:f.HUMAN_PLAY,agent:n,reward:0,lastReward:"_",botRewards:[],costOfLiving:-.2,failRate:.1,workingAsync:!1},a.myRef=r.a.createRef(),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.focusDiv(),this.worker=new b.a,this.worker.addEventListener("message",(function(t){e.setState({workingAsync:!1});var a=e.state.agent;t.data[a[0]][a[1]].agent=!0;for(var n=0;n<t.data.length;n++)for(var r=0;r<t.data[0].length;r++)t.data[n][r].type=e.state.grid[n][r].type;e.setState({grid:t.data})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App",tabIndex:0,onClickCapture:this.focusDiv},r.a.createElement(R,{setMode:this.setMode,mode:this.state.mode,costOfLiving:this.state.costOfLiving,updateCostOfLiving:this.updateCostOfLiving,failRate:this.state.failRate,updateFailRate:this.updateFailRate,trainAsync:this.trainAsync,workingAsync:this.state.workingAsync}),r.a.createElement(w,{data:this.state.grid,rewardsData:this.state.botRewards,switchType:this.switchType,aRef:this.myRef,keyDownFunc:this.handleKeyDown,currReward:this.state.reward,lastReward:this.state.lastReward,resetRewards:function(){return e.setState({botRewards:[]})}}))}}]),t}(r.a.Component);l.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.2ed61fa2.chunk.js.map